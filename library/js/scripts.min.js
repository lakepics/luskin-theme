"use strict";function updateViewportDimensions(){var e=window,t=document,a=t.documentElement,n=t.getElementsByTagName("body")[0],i=e.innerWidth||a.clientWidth||n.clientWidth,o=e.innerHeight||a.clientHeight||n.clientHeight;return{width:i,height:o}}function loadGravatars(){viewport=updateViewportDimensions(),viewport.width>=768&&jQuery(".comment img[data-gravatar]").each(function(){jQuery(this).attr("src",jQuery(this).attr("data-gravatar"))})}var viewport=updateViewportDimensions(),waitForFinalEvent=function(){var e={};return function(t,a,n){n||(n="Don't call this twice without a uniqueId"),e[n]&&clearTimeout(e[n]),e[n]=setTimeout(t,a)}}(),timeToWaitForLast=100;jQuery(document).ready(function(e){function t(){781>r.width()?(n.attr("aria-expanded","false"),i.attr("aria-expanded","false"),n.attr("aria-controls","primary-menu")):(n.removeAttr("aria-expanded"),i.removeAttr("aria-expanded"),n.removeAttr("aria-controls"))}var a,n,i,o=e("body"),r=e(window);a=e("#primary-navigation"),n=a.find(".menu-toggle"),i=a.find(".nav-menu"),function(){return a&&n?i&&i.children().length?void n.on("click.twentyfourteen",function(){a.toggleClass("toggled-on"),a.hasClass("toggled-on")?(e(this).attr("aria-expanded","true"),i.attr("aria-expanded","true")):(e(this).attr("aria-expanded","false"),i.attr("aria-expanded","false"))}):void n.hide():void 0}(),r.on("hashchange.twentyfourteen",function(){var e,t=location.hash.substring(1);t&&(e=document.getElementById(t),e&&(/^(?:a|select|input|button|textarea)$/i.test(e.tagName)||(e.tabIndex=-1),e.focus(),window.scrollBy(0,-80)))}),e(function(){if(e(".search-toggle").on("click.twentyfourteen",function(t){var a=e(this),n=e("#search-container"),i=a.find("a");a.toggleClass("active"),n.toggleClass("hide"),a.hasClass("active")?i.attr("aria-expanded","true"):i.attr("aria-expanded","false"),(a.is(".active")||e(".search-toggle .screen-reader-text")[0]===t.target)&&n.find(".search-field").focus()}),r.width()>781){var t,a,n=e("#masthead").height();n>48&&o.removeClass("masthead-fixed"),o.is(".header-image")&&(t=o.is(".admin-bar")?e("#wpadminbar").height():0,a=e("#masthead").offset().top-t,r.on("scroll.twentyfourteen",function(){r.scrollTop()>a&&49>n?o.addClass("masthead-fixed"):o.removeClass("masthead-fixed")}))}e(".primary-navigation, .secondary-navigation").find("a").on("focus.twentyfourteen blur.twentyfourteen",function(){e(this).parents().toggleClass("focus")})}),r.on("load.twentyfourteen",t).on("resize.twentyfourteen",function(){t()}),r.load(function(){e.isFunction(e.fn.masonry)&&e("#footer-sidebar").masonry({itemSelector:".widget",columnWidth:function(e){return e/4},gutterWidth:0,isResizable:!0,isRTL:e("body").is(".rtl")}),o.is(".slider")&&e(".featured-content").featuredslider({selector:".featured-content-inner > article",controlsContainer:".featured-content"})}),e("html").addClass("js");for(var s=0,d=document.getElementsByTagName("input").length;d>s;s++)document.getElementsByTagName("input")[s].className+=" "+document.getElementsByTagName("input")[s].type;for(var l=window.location.hostname,c=document.getElementsByTagName("a"),u=/^https?:\/\/(www.)?/i,s=0,d=c.length;d>s;s++)u.test(c[s].href)&&-1==c[s].href.toLowerCase().indexOf(l)&&(c[s].target="_blank",c[s].className+=" external");e("textarea, input:text").bind("focus click",function(){this.value==this.defaultValue&&(this.value="")}).bind("blur",function(){""==this.value&&(this.value=this.defaultValue)}),e("#main-navigation").clone().insertAfter(".mobile-navigation > a.logo-ucla-mobile").removeAttr("id"),e("#toggle-menu").bind("click touch",function(){e("div.mobile-navigation").hasClass("open")?(e("div.mobile-navigation").animate({width:"0px"},300).removeClass("open").css({display:"hidden"}),e("#container, .not-frontpage #header").animate({left:"0px"},300)):(e("div.mobile-navigation").animate({width:"300px"},300).addClass("open").css({display:"block"}),e("#container, .not-frontpage #header").animate({left:"300px"},300))}),e(".room-types-mobile .room-type-div-toggle").hide(),e(".room-types-mobile .room-type-div-toggle-trigger").bind("click touch",function(){e(this).next(".room-type-div-toggle").slideToggle("fast")}),e(function(){})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYnJhcnkvanMvc2NyaXB0cy5qcyJdLCJuYW1lcyI6WyJ1cGRhdGVWaWV3cG9ydERpbWVuc2lvbnMiLCJ3Iiwid2luZG93IiwiZCIsImRvY3VtZW50IiwiZSIsImRvY3VtZW50RWxlbWVudCIsImciLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsIngiLCJpbm5lcldpZHRoIiwiY2xpZW50V2lkdGgiLCJ5IiwiaW5uZXJIZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJ3aWR0aCIsImhlaWdodCIsImxvYWRHcmF2YXRhcnMiLCJ2aWV3cG9ydCIsImpRdWVyeSIsImVhY2giLCJ0aGlzIiwiYXR0ciIsIndhaXRGb3JGaW5hbEV2ZW50IiwidGltZXJzIiwiY2FsbGJhY2siLCJtcyIsInVuaXF1ZUlkIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsInRpbWVUb1dhaXRGb3JMYXN0IiwicmVhZHkiLCIkIiwib25SZXNpemVBUklBIiwiX3dpbmRvdyIsImJ1dHRvbiIsIm1lbnUiLCJyZW1vdmVBdHRyIiwibmF2IiwiYm9keSIsImZpbmQiLCJjaGlsZHJlbiIsImxlbmd0aCIsIm9uIiwidG9nZ2xlQ2xhc3MiLCJoYXNDbGFzcyIsImhpZGUiLCJlbGVtZW50IiwiaGFzaCIsImxvY2F0aW9uIiwic3Vic3RyaW5nIiwiZ2V0RWxlbWVudEJ5SWQiLCJ0ZXN0IiwidGFnTmFtZSIsInRhYkluZGV4IiwiZm9jdXMiLCJzY3JvbGxCeSIsImV2ZW50IiwidGhhdCIsIndyYXBwZXIiLCJjb250YWluZXIiLCJpcyIsInRhcmdldCIsInRvb2xiYXJPZmZzZXQiLCJtYXN0aGVhZE9mZnNldCIsIm1hc3RoZWFkSGVpZ2h0IiwicmVtb3ZlQ2xhc3MiLCJvZmZzZXQiLCJ0b3AiLCJzY3JvbGxUb3AiLCJhZGRDbGFzcyIsInBhcmVudHMiLCJsb2FkIiwiaXNGdW5jdGlvbiIsImZuIiwibWFzb25yeSIsIml0ZW1TZWxlY3RvciIsImNvbHVtbldpZHRoIiwiY29udGFpbmVyV2lkdGgiLCJndXR0ZXJXaWR0aCIsImlzUmVzaXphYmxlIiwiaXNSVEwiLCJmZWF0dXJlZHNsaWRlciIsInNlbGVjdG9yIiwiY29udHJvbHNDb250YWluZXIiLCJpIiwibGVuIiwiY2xhc3NOYW1lIiwidHlwZSIsImhvc3RuYW1lIiwibGlua3MiLCJwYXR0ZXJuIiwiaHJlZiIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsImJpbmQiLCJ2YWx1ZSIsImRlZmF1bHRWYWx1ZSIsImNsb25lIiwiaW5zZXJ0QWZ0ZXIiLCJhbmltYXRlIiwiY3NzIiwiZGlzcGxheSIsImxlZnQiLCJuZXh0Iiwic2xpZGVUb2dnbGUiXSwibWFwcGluZ3MiOiJBQUFBLFlBc0JBLFNBQVNBLDRCQUNMLEdBQUlDLEdBQUlDLE9BQ0pDLEVBQUlDLFNBQ0pDLEVBQUlGLEVBQUVHLGdCQUNOQyxFQUFJSixFQUFFSyxxQkFBcUIsUUFBUSxHQUNuQ0MsRUFBSVIsRUFBRVMsWUFBY0wsRUFBRU0sYUFBZUosRUFBRUksWUFDdkNDLEVBQUlYLEVBQUVZLGFBQWVSLEVBQUVTLGNBQWdCUCxFQUFFTyxZQUM3QyxRQUNJQyxNQUFPTixFQUNQTyxPQUFRSixHQTRFaEIsUUFBU0ssaUJBRUxDLFNBQVdsQiwyQkFFUGtCLFNBQVNILE9BQVMsS0FDbEJJLE9BQU8sK0JBQStCQyxLQUFLLFdBQ3ZDRCxPQUFPRSxNQUFNQyxLQUFLLE1BQU9ILE9BQU9FLE1BQU1DLEtBQUssb0JBOUV2RCxHQUFJSixVQUFXbEIsMkJBT1h1QixrQkFBb0IsV0FDcEIsR0FBSUMsS0FDSixPQUFPLFVBQVVDLEVBQVVDLEVBQUlDLEdBQ3RCQSxJQUNEQSxFQUFXLDRDQUVYSCxFQUFPRyxJQUNQQyxhQUFhSixFQUFPRyxJQUV4QkgsRUFBT0csR0FBWUUsV0FBV0osRUFBVUMsT0FLNUNJLGtCQUFvQixHQWlFeEJYLFFBQU9mLFVBQVUyQixNQUFNLFNBQVVDLEdBQUcsUUE0SXZCQyxLQUVELElBQU1DLEVBQVFuQixTQUNkb0IsRUFBT2IsS0FBSyxnQkFBaUIsU0FDN0JjLEVBQUtkLEtBQUssZ0JBQWlC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J3VzZSBzdHJpY3QnO1xuXG4vKlxuICogQm9uZXMgU2NyaXB0cyBGaWxlXG4gKiBBdXRob3I6IEVkZGllIE1hY2hhZG9cbiAqXG4gKiBUaGlzIGZpbGUgc2hvdWxkIGNvbnRhaW4gYW55IGpzIHNjcmlwdHMgeW91IHdhbnQgdG8gYWRkIHRvIHRoZSBzaXRlLlxuICogSW5zdGVhZCBvZiBjYWxsaW5nIGl0IGluIHRoZSBoZWFkZXIgb3IgdGhyb3dpbmcgaXQgaW5zaWRlIHdwX2hlYWQoKVxuICogdGhpcyBmaWxlIHdpbGwgYmUgY2FsbGVkIGF1dG9tYXRpY2FsbHkgaW4gdGhlIGZvb3RlciBzbyBhcyBub3QgdG9cbiAqIHNsb3cgdGhlIHBhZ2UgbG9hZC5cbiAqXG4gKiBUaGVyZSBhcmUgYSBsb3Qgb2YgZXhhbXBsZSBmdW5jdGlvbnMgYW5kIHRvb2xzIGluIGhlcmUuIElmIHlvdSBkb24ndFxuICogbmVlZCBhbnkgb2YgaXQsIGp1c3QgcmVtb3ZlIGl0LiBUaGV5IGFyZSBtZWFudCB0byBiZSBoZWxwZXJzIGFuZCBhcmVcbiAqIG5vdCByZXF1aXJlZC4gSXQncyB5b3VyIHdvcmxkIGJhYnksIHlvdSBjYW4gZG8gd2hhdGV2ZXIgeW91IHdhbnQuXG4gKi9cblxuLypcbiAqIEdldCBWaWV3cG9ydCBEaW1lbnNpb25zXG4gKiByZXR1cm5zIG9iamVjdCB3aXRoIHZpZXdwb3J0IGRpbWVuc2lvbnMgdG8gbWF0Y2ggY3NzIGluIHdpZHRoIGFuZCBoZWlnaHQgcHJvcGVydGllc1xuICogKCBzb3VyY2U6IGh0dHA6Ly9hbmR5bGFuZ3Rvbi5jby51ay9ibG9nL2RldmVsb3BtZW50L2dldC12aWV3cG9ydC1zaXplLXdpZHRoLWFuZC1oZWlnaHQtamF2YXNjcmlwdCApXG4gKi9cblxuZnVuY3Rpb24gdXBkYXRlVmlld3BvcnREaW1lbnNpb25zKCkge1xuICAgIHZhciB3ID0gd2luZG93LFxuICAgICAgICBkID0gZG9jdW1lbnQsXG4gICAgICAgIGUgPSBkLmRvY3VtZW50RWxlbWVudCxcbiAgICAgICAgZyA9IGQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXSxcbiAgICAgICAgeCA9IHcuaW5uZXJXaWR0aCB8fCBlLmNsaWVudFdpZHRoIHx8IGcuY2xpZW50V2lkdGgsXG4gICAgICAgIHkgPSB3LmlubmVySGVpZ2h0IHx8IGUuY2xpZW50SGVpZ2h0IHx8IGcuY2xpZW50SGVpZ2h0O1xuICAgIHJldHVybiB7XG4gICAgICAgIHdpZHRoOiB4LFxuICAgICAgICBoZWlnaHQ6IHlcbiAgICB9O1xufVxuLy8gc2V0dGluZyB0aGUgdmlld3BvcnQgd2lkdGhcbnZhciB2aWV3cG9ydCA9IHVwZGF0ZVZpZXdwb3J0RGltZW5zaW9ucygpO1xuXG4vKlxuICogVGhyb3R0bGUgUmVzaXplLXRyaWdnZXJlZCBFdmVudHNcbiAqIFdyYXAgeW91ciBhY3Rpb25zIGluIHRoaXMgZnVuY3Rpb24gdG8gdGhyb3R0bGUgdGhlIGZyZXF1ZW5jeSBvZiBmaXJpbmcgdGhlbSBvZmYsIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2UsIGVzcC4gb24gbW9iaWxlLlxuICogKCBzb3VyY2U6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjg1NDQwNy9qYXZhc2NyaXB0LWpxdWVyeS13aW5kb3ctcmVzaXplLWhvdy10by1maXJlLWFmdGVyLXRoZS1yZXNpemUtaXMtY29tcGxldGVkIClcbiAqL1xudmFyIHdhaXRGb3JGaW5hbEV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aW1lcnMgPSB7fTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGNhbGxiYWNrLCBtcywgdW5pcXVlSWQpIHtcbiAgICAgICAgaWYgKCF1bmlxdWVJZCkge1xuICAgICAgICAgICAgdW5pcXVlSWQgPSBcIkRvbid0IGNhbGwgdGhpcyB0d2ljZSB3aXRob3V0IGEgdW5pcXVlSWRcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGltZXJzW3VuaXF1ZUlkXSkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyc1t1bmlxdWVJZF0pO1xuICAgICAgICB9XG4gICAgICAgIHRpbWVyc1t1bmlxdWVJZF0gPSBzZXRUaW1lb3V0KGNhbGxiYWNrLCBtcyk7XG4gICAgfTtcbn0oKTtcblxuLy8gaG93IGxvbmcgdG8gd2FpdCBiZWZvcmUgZGVjaWRpbmcgdGhlIHJlc2l6ZSBoYXMgc3RvcHBlZCwgaW4gbXMuIEFyb3VuZCA1MC0xMDAgc2hvdWxkIHdvcmsgb2suXG52YXIgdGltZVRvV2FpdEZvckxhc3QgPSAxMDA7XG5cbi8qXG4gKiBIZXJlJ3MgYW4gZXhhbXBsZSBzbyB5b3UgY2FuIHNlZSBob3cgd2UncmUgdXNpbmcgdGhlIGFib3ZlIGZ1bmN0aW9uXG4gKlxuICogVGhpcyBpcyBjb21tZW50ZWQgb3V0IHNvIGl0IHdvbid0IHdvcmssIGJ1dCB5b3UgY2FuIGNvcHkgaXQgYW5kXG4gKiByZW1vdmUgdGhlIGNvbW1lbnRzLlxuICpcbiAqXG4gKlxuICogSWYgd2Ugd2FudCB0byBvbmx5IGRvIGl0IG9uIGEgY2VydGFpbiBwYWdlLCB3ZSBjYW4gc2V0dXAgY2hlY2tzIHNvIHdlIGRvIGl0XG4gKiBhcyBlZmZpY2llbnQgYXMgcG9zc2libGUuXG4gKlxuICogaWYoIHR5cGVvZiBpc19ob21lID09PSBcInVuZGVmaW5lZFwiICkgdmFyIGlzX2hvbWUgPSAkKCdib2R5JykuaGFzQ2xhc3MoJ2hvbWUnKTtcbiAqXG4gKiBUaGlzIG9uY2UgY2hlY2tzIHRvIHNlZSBpZiB5b3UncmUgb24gdGhlIGhvbWUgcGFnZSBiYXNlZCBvbiB0aGUgYm9keSBjbGFzc1xuICogV2UgY2FuIHRoZW4gdXNlIHRoYXQgY2hlY2sgdG8gcGVyZm9ybSBhY3Rpb25zIG9uIHRoZSBob21lIHBhZ2Ugb25seVxuICpcbiAqIFdoZW4gdGhlIHdpbmRvdyBpcyByZXNpemVkLCB3ZSBwZXJmb3JtIHRoaXMgZnVuY3Rpb25cbiAqICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24gKCkge1xuICpcbiAqICAgIC8vIGlmIHdlJ3JlIG9uIHRoZSBob21lIHBhZ2UsIHdlIHdhaXQgdGhlIHNldCBhbW91bnQgKGluIGZ1bmN0aW9uIGFib3ZlKSB0aGVuIGZpcmUgdGhlIGZ1bmN0aW9uXG4gKiAgICBpZiggaXNfaG9tZSApIHsgd2FpdEZvckZpbmFsRXZlbnQoIGZ1bmN0aW9uKCkge1xuICpcbiAqXHQvLyB1cGRhdGUgdGhlIHZpZXdwb3J0LCBpbiBjYXNlIHRoZSB3aW5kb3cgc2l6ZSBoYXMgY2hhbmdlZFxuICpcdHZpZXdwb3J0ID0gdXBkYXRlVmlld3BvcnREaW1lbnNpb25zKCk7XG4gKlxuICogICAgICAvLyBpZiB3ZSdyZSBhYm92ZSBvciBlcXVhbCB0byA3NjggZmlyZSB0aGlzIG9mZlxuICogICAgICBpZiggdmlld3BvcnQud2lkdGggPj0gNzY4ICkge1xuICogICAgICAgIGNvbnNvbGUubG9nKCdPbiBob21lIHBhZ2UgYW5kIHdpbmRvdyBzaXplZCB0byA3Njggd2lkdGggb3IgbW9yZS4nKTtcbiAqICAgICAgfSBlbHNlIHtcbiAqICAgICAgICAvLyBvdGhlcndpc2UsIGxldCdzIGRvIHRoaXMgaW5zdGVhZFxuICogICAgICAgIGNvbnNvbGUubG9nKCdOb3Qgb24gaG9tZSBwYWdlLCBvciB3aW5kb3cgc2l6ZWQgdG8gbGVzcyB0aGFuIDc2OC4nKTtcbiAqICAgICAgfVxuICpcbiAqICAgIH0sIHRpbWVUb1dhaXRGb3JMYXN0LCBcInlvdXItZnVuY3Rpb24taWRlbnRpZmllci1zdHJpbmdcIik7IH1cbiAqIH0pO1xuICpcbiAqIFByZXR0eSBjb29sIGh1aD8gWW91IGNhbiBjcmVhdGUgZnVuY3Rpb25zIGxpa2UgdGhpcyB0byBjb25kaXRpb25hbGx5IGxvYWRcbiAqIGNvbnRlbnQgYW5kIG90aGVyIHN0dWZmIGRlcGVuZGVudCBvbiB0aGUgdmlld3BvcnQuXG4gKiBSZW1lbWJlciB0aGF0IG1vYmlsZSBkZXZpY2VzIGFuZCBqYXZhc2NyaXB0IGFyZW4ndCB0aGUgYmVzdCBvZiBmcmllbmRzLlxuICogS2VlcCBpdCBsaWdodCBhbmQgYWx3YXlzIG1ha2Ugc3VyZSB0aGUgbGFyZ2VyIHZpZXdwb3J0cyBhcmUgZG9pbmcgdGhlIGhlYXZ5IGxpZnRpbmcuXG4gKlxuICovXG5cbi8qXG4gKiBXZSdyZSBnb2luZyB0byBzd2FwIG91dCB0aGUgZ3JhdmF0YXJzLlxuICogSW4gdGhlIGZ1bmN0aW9ucy5waHAgZmlsZSwgeW91IGNhbiBzZWUgd2UncmUgbm90IGxvYWRpbmcgdGhlIGdyYXZhdGFyXG4gKiBpbWFnZXMgb24gbW9iaWxlIHRvIHNhdmUgYmFuZHdpZHRoLiBPbmNlIHdlIGhpdCBhbiBhY2NlcHRhYmxlIHZpZXdwb3J0XG4gKiB0aGVuIHdlIGNhbiBzd2FwIG91dCB0aG9zZSBpbWFnZXMgc2luY2UgdGhleSBhcmUgbG9jYXRlZCBpbiBhIGRhdGEgYXR0cmlidXRlLlxuICovXG5mdW5jdGlvbiBsb2FkR3JhdmF0YXJzKCkge1xuICAgIC8vIHNldCB0aGUgdmlld3BvcnQgdXNpbmcgdGhlIGZ1bmN0aW9uIGFib3ZlXG4gICAgdmlld3BvcnQgPSB1cGRhdGVWaWV3cG9ydERpbWVuc2lvbnMoKTtcbiAgICAvLyBpZiB0aGUgdmlld3BvcnQgaXMgdGFibGV0IG9yIGxhcmdlciwgd2UgbG9hZCBpbiB0aGUgZ3JhdmF0YXJzXG4gICAgaWYgKHZpZXdwb3J0LndpZHRoID49IDc2OCkge1xuICAgICAgICBqUXVlcnkoJy5jb21tZW50IGltZ1tkYXRhLWdyYXZhdGFyXScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgalF1ZXJ5KHRoaXMpLmF0dHIoJ3NyYycsIGpRdWVyeSh0aGlzKS5hdHRyKCdkYXRhLWdyYXZhdGFyJykpO1xuICAgICAgICB9KTtcbiAgICB9XG59IC8vIGVuZCBmdW5jdGlvblxuXG4vKlxuICogUHV0IGFsbCBvZiB5b3VyIHJlZ3VsYXIgalF1ZXJ5IGluIGhlcmUuXG4gKi9cbmpRdWVyeShkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCQpIHtcblxuICAgIC8qXG4gICAgICogTGV0J3MgZmlyZSBvZmYgdGhlIGdyYXZhdGFyIGZ1bmN0aW9uXG4gICAgICogWW91IGNhbiByZW1vdmUgdGhpcyBpZiB5b3UgZG9uJ3QgbmVlZCBpdFxuICAgICAqL1xuICAgIC8vIGxvYWRHcmF2YXRhcnMoKTtcblxuICAgIC8qXG4gICAgICogVGhlbWUgZnVuY3Rpb25zXG4gICAgICpcbiAgICAgKiBDb250YWlucyBoYW5kbGVycyBmb3IgbmF2aWdhdGlvbiwgYWNjZXNzaWJpbGl0eSwgaGVhZGVyIHNpemluZ1xuICAgICAqIGZvb3RlciB3aWRnZXRzIGFuZCBGZWF0dXJlZCBDb250ZW50IHNsaWRlclxuICAgICAqL1xuICAgIHZhciBib2R5ID0gJCgnYm9keScpLFxuICAgICAgICBfd2luZG93ID0gJCh3aW5kb3cpLFxuICAgICAgICBuYXYsXG4gICAgICAgIGJ1dHRvbixcbiAgICAgICAgbWVudTtcblxuICAgIG5hdiA9ICQoJyNwcmltYXJ5LW5hdmlnYXRpb24nKTtcbiAgICBidXR0b24gPSBuYXYuZmluZCgnLm1lbnUtdG9nZ2xlJyk7XG4gICAgbWVudSA9IG5hdi5maW5kKCcubmF2LW1lbnUnKTtcblxuICAgIC8vIEVuYWJsZSBtZW51IHRvZ2dsZSBmb3Igc21hbGwgc2NyZWVucy5cbiAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIW5hdiB8fCAhYnV0dG9uKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBIaWRlIGJ1dHRvbiBpZiBtZW51IGlzIG1pc3Npbmcgb3IgZW1wdHkuXG4gICAgICAgIGlmICghbWVudSB8fCAhbWVudS5jaGlsZHJlbigpLmxlbmd0aCkge1xuICAgICAgICAgICAgYnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGJ1dHRvbi5vbignY2xpY2sudHdlbnR5Zm91cnRlZW4nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBuYXYudG9nZ2xlQ2xhc3MoJ3RvZ2dsZWQtb24nKTtcbiAgICAgICAgICAgIGlmIChuYXYuaGFzQ2xhc3MoJ3RvZ2dsZWQtb24nKSkge1xuICAgICAgICAgICAgICAgICQodGhpcykuYXR0cignYXJpYS1leHBhbmRlZCcsICd0cnVlJyk7XG4gICAgICAgICAgICAgICAgbWVudS5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgICAgICAgbWVudS5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pKCk7XG5cbiAgICAvKlxuICAgICAqIE1ha2VzIFwic2tpcCB0byBjb250ZW50XCIgbGluayB3b3JrIGNvcnJlY3RseSBpbiBJRTkgYW5kIENocm9tZSBmb3IgYmV0dGVyXG4gICAgICogYWNjZXNzaWJpbGl0eS5cbiAgICAgKlxuICAgICAqIEBsaW5rIGh0dHA6Ly93d3cubmN6b25saW5lLm5ldC9ibG9nLzIwMTMvMDEvMTUvZml4aW5nLXNraXAtdG8tY29udGVudC1saW5rcy9cbiAgICAgKi9cbiAgICBfd2luZG93Lm9uKCdoYXNoY2hhbmdlLnR3ZW50eWZvdXJ0ZWVuJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaGFzaCA9IGxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpLFxuICAgICAgICAgICAgZWxlbWVudDtcblxuICAgICAgICBpZiAoIWhhc2gpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChoYXNoKTtcblxuICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKCEvXig/OmF8c2VsZWN0fGlucHV0fGJ1dHRvbnx0ZXh0YXJlYSkkL2kudGVzdChlbGVtZW50LnRhZ05hbWUpKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBlbGVtZW50LmZvY3VzKCk7XG5cbiAgICAgICAgICAgIC8vIFJlcG9zaXRpb25zIHRoZSB3aW5kb3cgb24ganVtcC10by1hbmNob3IgdG8gYWNjb3VudCBmb3IgaGVhZGVyIGhlaWdodC5cbiAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxCeSgwLCAtODApO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAkKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvLyBTZWFyY2ggdG9nZ2xlLlxuICAgICAgICAkKCcuc2VhcmNoLXRvZ2dsZScpLm9uKCdjbGljay50d2VudHlmb3VydGVlbicsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdmFyIHRoYXQgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgIHdyYXBwZXIgPSAkKCcjc2VhcmNoLWNvbnRhaW5lcicpLFxuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IHRoYXQuZmluZCgnYScpO1xuXG4gICAgICAgICAgICB0aGF0LnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIHdyYXBwZXIudG9nZ2xlQ2xhc3MoJ2hpZGUnKTtcblxuICAgICAgICAgICAgaWYgKHRoYXQuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuYXR0cignYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhhdC5pcygnLmFjdGl2ZScpIHx8ICQoJy5zZWFyY2gtdG9nZ2xlIC5zY3JlZW4tcmVhZGVyLXRleHQnKVswXSA9PT0gZXZlbnQudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5maW5kKCcuc2VhcmNoLWZpZWxkJykuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogRml4ZWQgaGVhZGVyIGZvciBsYXJnZSBzY3JlZW4uXG4gICAgICAgICAqIElmIHRoZSBoZWFkZXIgYmVjb21lcyBtb3JlIHRoYW4gNDhweCB0YWxsLCB1bmZpeCB0aGUgaGVhZGVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGUgY2FsbGJhY2sgb24gdGhlIHNjcm9sbCBldmVudCBpcyBvbmx5IGFkZGVkIGlmIHRoZXJlIGlzIGEgaGVhZGVyXG4gICAgICAgICAqIGltYWdlIGFuZCB3ZSBhcmUgbm90IG9uIG1vYmlsZS5cbiAgICAgICAgICovXG4gICAgICAgIGlmIChfd2luZG93LndpZHRoKCkgPiA3ODEpIHtcbiAgICAgICAgICAgIHZhciBtYXN0aGVhZEhlaWdodCA9ICQoJyNtYXN0aGVhZCcpLmhlaWdodCgpLFxuICAgICAgICAgICAgICAgIHRvb2xiYXJPZmZzZXQsXG4gICAgICAgICAgICAgICAgbWFzdGhlYWRPZmZzZXQ7XG5cbiAgICAgICAgICAgIGlmIChtYXN0aGVhZEhlaWdodCA+IDQ4KSB7XG4gICAgICAgICAgICAgICAgYm9keS5yZW1vdmVDbGFzcygnbWFzdGhlYWQtZml4ZWQnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGJvZHkuaXMoJy5oZWFkZXItaW1hZ2UnKSkge1xuICAgICAgICAgICAgICAgIHRvb2xiYXJPZmZzZXQgPSBib2R5LmlzKCcuYWRtaW4tYmFyJykgPyAkKCcjd3BhZG1pbmJhcicpLmhlaWdodCgpIDogMDtcbiAgICAgICAgICAgICAgICBtYXN0aGVhZE9mZnNldCA9ICQoJyNtYXN0aGVhZCcpLm9mZnNldCgpLnRvcCAtIHRvb2xiYXJPZmZzZXQ7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCdzY3JvbGwudHdlbnR5Zm91cnRlZW4nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfd2luZG93LnNjcm9sbFRvcCgpID4gbWFzdGhlYWRPZmZzZXQgJiYgbWFzdGhlYWRIZWlnaHQgPCA0OSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYm9keS5hZGRDbGFzcygnbWFzdGhlYWQtZml4ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHkucmVtb3ZlQ2xhc3MoJ21hc3RoZWFkLWZpeGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvY3VzIHN0eWxlcyBmb3IgbWVudXMuXG4gICAgICAgICQoJy5wcmltYXJ5LW5hdmlnYXRpb24sIC5zZWNvbmRhcnktbmF2aWdhdGlvbicpLmZpbmQoJ2EnKS5vbignZm9jdXMudHdlbnR5Zm91cnRlZW4gYmx1ci50d2VudHlmb3VydGVlbicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQodGhpcykucGFyZW50cygpLnRvZ2dsZUNsYXNzKCdmb2N1cycpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEBzdW1tYXJ5IEFkZCBvciByZW1vdmUgQVJJQSBhdHRyaWJ1dGVzLlxuICAgICAqIFVzZXMgalF1ZXJ5J3Mgd2lkdGgoKSBmdW5jdGlvbiB0byBkZXRlcm1pbmUgdGhlIHNpemUgb2YgdGhlIHdpbmRvdyBhbmQgYWRkXG4gICAgICogdGhlIGRlZmF1bHQgQVJJQSBhdHRyaWJ1dGVzIGZvciB0aGUgbWVudSB0b2dnbGUgaWYgaXQncyB2aXNpYmxlLlxuICAgICAqIEBzaW5jZSBUd2VudHkgRm91cnRlZW4gMS40XG4gICAgICovXG4gICAgZnVuY3Rpb24gb25SZXNpemVBUklBKCkge1xuXG4gICAgICAgIGlmICg3ODEgPiBfd2luZG93LndpZHRoKCkpIHtcbiAgICAgICAgICAgIGJ1dHRvbi5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgICBtZW51LmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcbiAgICAgICAgICAgIGJ1dHRvbi5hdHRyKCdhcmlhLWNvbnRyb2xzJywgJ3ByaW1hcnktbWVudScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnV0dG9uLnJlbW92ZUF0dHIoJ2FyaWEtZXhwYW5kZWQnKTtcbiAgICAgICAgICAgIG1lbnUucmVtb3ZlQXR0cignYXJpYS1leHBhbmRlZCcpO1xuICAgICAgICAgICAgYnV0dG9uLnJlbW92ZUF0dHIoJ2FyaWEtY29udHJvbHMnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF93aW5kb3cub24oJ2xvYWQudHdlbnR5Zm91cnRlZW4nLCBvblJlc2l6ZUFSSUEpLm9uKCdyZXNpemUudHdlbnR5Zm91cnRlZW4nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG9uUmVzaXplQVJJQSgpO1xuICAgIH0pO1xuXG4gICAgX3dpbmRvdy5sb2FkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gQXJyYW5nZSBmb290ZXIgd2lkZ2V0cyB2ZXJ0aWNhbGx5LlxuICAgICAgICBpZiAoJC5pc0Z1bmN0aW9uKCQuZm4ubWFzb25yeSkpIHtcbiAgICAgICAgICAgICQoJyNmb290ZXItc2lkZWJhcicpLm1hc29ucnkoe1xuICAgICAgICAgICAgICAgIGl0ZW1TZWxlY3RvcjogJy53aWRnZXQnLFxuICAgICAgICAgICAgICAgIGNvbHVtbldpZHRoOiBmdW5jdGlvbiBjb2x1bW5XaWR0aChjb250YWluZXJXaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGFpbmVyV2lkdGggLyA0O1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZ3V0dGVyV2lkdGg6IDAsXG4gICAgICAgICAgICAgICAgaXNSZXNpemFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgaXNSVEw6ICQoJ2JvZHknKS5pcygnLnJ0bCcpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluaXRpYWxpemUgRmVhdHVyZWQgQ29udGVudCBzbGlkZXIuXG4gICAgICAgIGlmIChib2R5LmlzKCcuc2xpZGVyJykpIHtcbiAgICAgICAgICAgICQoJy5mZWF0dXJlZC1jb250ZW50JykuZmVhdHVyZWRzbGlkZXIoe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnLmZlYXR1cmVkLWNvbnRlbnQtaW5uZXIgPiBhcnRpY2xlJyxcbiAgICAgICAgICAgICAgICBjb250cm9sc0NvbnRhaW5lcjogJy5mZWF0dXJlZC1jb250ZW50J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSB1dGlscyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0vL1xuXG4gICAgJCgnaHRtbCcpLmFkZENsYXNzKCdqcycpO1xuXG4gICAgLy9hZGQgY2xhc3NlcyB0byBmb3JtIGlucHV0cyBiYXNlZCBvbiB0aGVpciB0eXBlXG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpW2ldLmNsYXNzTmFtZSArPSAnICcgKyBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKVtpXS50eXBlO1xuICAgIH1cblxuICAgIC8vb3BlbiBsaW5rcyBpbiBuZXcgd2luZG93ICh0YXJnZXQ9X2JsYW5rKTsgY2hlY2tzIGlmIHRoZSB1cmwgaXMgZXh0ZXJuYWxcbiAgICB2YXIgaG9zdG5hbWUgPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUsXG4gICAgICAgIGxpbmtzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2EnKSxcbiAgICAgICAgcGF0dGVybiA9IC9eaHR0cHM/OlxcL1xcLyh3d3cuKT8vaTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBsaW5rcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAocGF0dGVybi50ZXN0KGxpbmtzW2ldLmhyZWYpICYmIGxpbmtzW2ldLmhyZWYudG9Mb3dlckNhc2UoKS5pbmRleE9mKGhvc3RuYW1lKSA9PSAtMSkge1xuICAgICAgICAgICAgbGlua3NbaV0udGFyZ2V0ID0gXCJfYmxhbmtcIjtcbiAgICAgICAgICAgIGxpbmtzW2ldLmNsYXNzTmFtZSArPSAnIGV4dGVybmFsJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vY2xlYXIgZm9ybSBmaWVsZHMgb24gZm9jdXNcbiAgICAkKCd0ZXh0YXJlYSwgaW5wdXQ6dGV4dCcpLmJpbmQoJ2ZvY3VzIGNsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy52YWx1ZSA9PSB0aGlzLmRlZmF1bHRWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9ICcnO1xuICAgICAgICB9XG4gICAgfSkuYmluZCgnYmx1cicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPT0gJycpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy9lcXVhbCBoZWlnaHQgY29sdW1ucyBmdW5jdGlvblxuICAgIGZ1bmN0aW9uIGVxdWFsSGVpZ2h0KGdyb3VwKSB7XG4gICAgICAgIHZhciB0YWxsZXN0ID0gMDtcbiAgICAgICAgZ3JvdXAuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhpc0hlaWdodCA9ICQodGhpcykuaGVpZ2h0KCk7XG4gICAgICAgICAgICBpZiAodGhpc0hlaWdodCA+IHRhbGxlc3QpIHtcbiAgICAgICAgICAgICAgICB0YWxsZXN0ID0gdGhpc0hlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGdyb3VwLmhlaWdodCh0YWxsZXN0KTtcbiAgICB9XG4gICAgLy9lcXVhbEhlaWdodCgkKFwiLy9oZXJlIHB1dCB0aGUgc2VsZWN0b3JcIikpO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gb3RoZXIgc2NyaXB0cyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS8vXG5cbiAgICAvLyBtb2JpbGUgbmF2XG4gICAgJCgnI21haW4tbmF2aWdhdGlvbicpLmNsb25lKCkuaW5zZXJ0QWZ0ZXIoJy5tb2JpbGUtbmF2aWdhdGlvbiA+IGEubG9nby11Y2xhLW1vYmlsZScpLnJlbW92ZUF0dHIoJ2lkJyk7XG4gICAgJCgnI3RvZ2dsZS1tZW51JykuYmluZCgnY2xpY2sgdG91Y2gnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICgkKCdkaXYubW9iaWxlLW5hdmlnYXRpb24nKS5oYXNDbGFzcygnb3BlbicpKSB7XG4gICAgICAgICAgICAkKCdkaXYubW9iaWxlLW5hdmlnYXRpb24nKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICB3aWR0aDogXCIwcHhcIlxuICAgICAgICAgICAgfSwgMzAwKS5yZW1vdmVDbGFzcygnb3BlbicpLmNzcyh7XG4gICAgICAgICAgICAgICAgJ2Rpc3BsYXknOiAnaGlkZGVuJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKCcjY29udGFpbmVyLCAubm90LWZyb250cGFnZSAjaGVhZGVyJykuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgbGVmdDogXCIwcHhcIlxuICAgICAgICAgICAgfSwgMzAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQoJ2Rpdi5tb2JpbGUtbmF2aWdhdGlvbicpLmFuaW1hdGUoe1xuICAgICAgICAgICAgICAgIHdpZHRoOiBcIjMwMHB4XCJcbiAgICAgICAgICAgIH0sIDMwMCkuYWRkQ2xhc3MoJ29wZW4nKS5jc3Moe1xuICAgICAgICAgICAgICAgICdkaXNwbGF5JzogJ2Jsb2NrJ1xuICAgICAgICAgICAgfSk7O1xuICAgICAgICAgICAgJCgnI2NvbnRhaW5lciwgLm5vdC1mcm9udHBhZ2UgI2hlYWRlcicpLmFuaW1hdGUoe1xuICAgICAgICAgICAgICAgIGxlZnQ6IFwiMzAwcHhcIlxuICAgICAgICAgICAgfSwgMzAwKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gdG9vZ2xlIHJvb20gdHlwZVxuICAgICQoJy5yb29tLXR5cGVzLW1vYmlsZSAucm9vbS10eXBlLWRpdi10b2dnbGUnKS5oaWRlKCk7XG4gICAgJCgnLnJvb20tdHlwZXMtbW9iaWxlIC5yb29tLXR5cGUtZGl2LXRvZ2dsZS10cmlnZ2VyJykuYmluZCgnY2xpY2sgdG91Y2gnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgICAkKHRoaXMpLm5leHQoJy5yb29tLXR5cGUtZGl2LXRvZ2dsZScpLnNsaWRlVG9nZ2xlKCdmYXN0Jyk7XG4gICAgfSk7XG5cbiAgICAvLyBpbWdDZW50ZXJpbmdcbiAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyAkKFwiLmxheC1kaXItd3JhcHBlciBpbWdcIikuaW1nQ2VudGVyaW5nKHtcbiAgICAgICAgLy8gICAnZm9yY2VTbWFydCc6IHRydWUsICAgLy9jZW50ZXJpbmcgd2l0aG91dCBzaG93aW5nIGJhY2tncm91bmRcbiAgICAgICAgLy8gICAvLydmb3JjZVdpZHRoJzogdHJ1ZSwgICAvL2NlbnRlcmluZyB3aXRoIGZpeCB3aWR0aFxuICAgICAgICAvLyAgIC8vJ2ZvcmNlSGVpZ2h0JzogdHJ1ZSwgIC8vY2VudGVyaW5nIHdpdGggZml4IGhlaWdodFxuICAgICAgICAvLyAgICdiZ0NvbG9yJzogJyNDQ0MnICAgICAvL2VtcHR5IHNwYWNlIGNvbG9yXG4gICAgICAgIC8vIH0pO1xuICAgIH0pKCk7XG5cbiAgICAkKGZ1bmN0aW9uICgpIHt9KTtcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
